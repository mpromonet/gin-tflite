
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Try</title>
</head>
<body>
  <h1>Try mp4</h1>
  
  <input type="file" accept="video/mp4" onchange="start(this.files[0])">
  <br>
  <canvas id="canvasEl"></canvas>
  <br>
  
  <script type="module">
    import getVideoFrames from "https://deno.land/x/get_video_frames@v0.0.9/mod.js"

    window.start = async function(file) {
      let ctx = canvasEl.getContext("2d"); 
      let videoUrl = URL.createObjectURL(file);
      
      await getVideoFrames({
        videoUrl,
        onConfig: async function(config) {
          canvasEl.width = config.codedWidth;
          canvasEl.height = config.codedHeight;
        },
        onFrame: function(frame) {
          ctx.drawImage(frame, 0, 0, canvasEl.width, canvasEl.height);
          frame.close();
        },
      });
      
      URL.revokeObjectURL(file); // revoke video URL to prevent memory leak
      console.log("Done.");
    }
  </script>
</body>
</html>
